

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>dspace-python-client &mdash; dspace-python-client  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dspace" href="source/modules.html" />
    <link rel="prev" title="dspace-python-client Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> dspace-python-client
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#development">Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#python">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#poetry">Poetry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tests">Tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="source/modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dspace-python-client</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>dspace-python-client</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/readme.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#dspace-python-client" id="id1">dspace-python-client</a></p>
<ul>
<li><p><a class="reference internal" href="#usage" id="id2">Usage</a></p></li>
<li><p><a class="reference internal" href="#development" id="id3">Development</a></p>
<ul>
<li><p><a class="reference internal" href="#dependencies" id="id4">Dependencies</a></p></li>
<li><p><a class="reference internal" href="#installation" id="id5">Installation</a></p></li>
<li><p><a class="reference internal" href="#tests" id="id6">Tests</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="dspace-python-client">
<h1><a class="toc-backref" href="#id1">dspace-python-client</a><a class="headerlink" href="#dspace-python-client" title="Permalink to this headline">¶</a></h1>
<p>A Python client library for working with the DSpace API. This was written against the <a class="reference external" href="https://wiki.lyrasis.org/display/DSDOC6x/REST+API">DSpace version 6.x API</a> and will not work with later versions of DSpace.</p>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id2">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To install this library with <cite>pip</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="s2">&quot;git+https://github.com/mitlibraries/dspace-python-client.git@&lt;release-version-number&gt;#egg=dspace-python-client&quot;</span>
</pre></div>
</div>
<p>To install this library with <cite>pipenv</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">install</span> <span class="s2">&quot;git+https://github.com/mitlibraries/dspace-python-client.git@&lt;release-version-number&gt;#egg=dspace-python-client&quot;</span>
</pre></div>
</div>
<p>To authenticate the DSpace client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dspace.bitstream</span> <span class="kn">import</span> <span class="n">Bitstream</span>
<span class="kn">from</span> <span class="nn">dspace.client</span> <span class="kn">import</span> <span class="n">DSpaceClient</span>
<span class="kn">from</span> <span class="nn">dspace.item</span> <span class="kn">import</span> <span class="n">Item</span><span class="p">,</span> <span class="n">MetadataEntry</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">DSpaceClient</span><span class="p">(</span><span class="o">&lt;</span><span class="n">DSpace</span> <span class="n">API</span> <span class="n">URL</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="o">&lt;</span><span class="n">your</span> <span class="n">email</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">password</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>To post an item and associated bitstream with an authenticated client:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">title</span> <span class="o">=</span> <span class="n">MetadataEntry</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;dc.title&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Test Item&quot;</span><span class="p">)</span>
<span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">title</span><span class="p">])</span>
<span class="n">item</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">collection_handle</span><span class="o">=&lt;</span><span class="n">valid</span> <span class="n">DSpace</span> <span class="n">handle</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s2">&quot;1234.5/6789&quot;</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">bitstream</span> <span class="o">=</span> <span class="n">Bitstream</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test.txt&quot;</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;test.txt&quot;</span><span class="p">)</span>
<span class="n">bitstream</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">item_uuid</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="development">
<h2><a class="toc-backref" href="#id3">Development</a><a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dependencies">
<h3><a class="toc-backref" href="#id4">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<div class="section" id="python">
<h4>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>Version 3.9</p>
</div>
<div class="section" id="poetry">
<h4>Poetry<a class="headerlink" href="#poetry" title="Permalink to this headline">¶</a></h4>
<p>This project uses Poetry for dependency management and packaging.</p>
<p>You only need to install Poetry once, so if you’ve already installed it for another project you can skip this step. Poetry will automatically pick up the current Python version and use it to create virtualenvs accordingly.</p>
<p>To install poetry:</p>
<ul>
<li><p>Mac/unix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">poetry</span><span class="o">/</span><span class="n">poetry</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">poetry</span><span class="o">.</span><span class="n">py</span> <span class="o">|</span> <span class="n">python</span> <span class="o">-</span>
</pre></div>
</div>
</li>
<li><p>Windows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Invoke</span><span class="o">-</span><span class="n">WebRequest</span> <span class="o">-</span><span class="n">Uri</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">poetry</span><span class="o">/</span><span class="n">poetry</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">get</span><span class="o">-</span><span class="n">poetry</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">UseBasicParsing</span><span class="p">)</span><span class="o">.</span><span class="n">Content</span> <span class="o">|</span> <span class="n">python</span> <span class="o">-</span>
</pre></div>
</div>
</li>
</ul>
<p>Run <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">--version</span></code> to confirm installation.</p>
<p>See <a class="reference external" href="https://python-poetry.org/docs/#installation">Poetry installation docs</a> for configuration options and more information.</p>
</div>
</div>
<div class="section" id="installation">
<h3><a class="toc-backref" href="#id5">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>Install dspace-python-client for local development by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">MITLibraries</span><span class="o">/</span><span class="n">dspace</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">client</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">dspace</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">client</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
</div>
<div class="section" id="tests">
<h3><a class="toc-backref" href="#id6">Tests</a><a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h3>
<p>Tests can be run with <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code>.</p>
<p>This project uses <a class="reference external" href="https://vcrpy.readthedocs.io/en/latest/">vcrpy</a> to create test cassettes of real data for API calls. If you need to recreate the test cassettes or add new ones:</p>
<ol class="arabic">
<li><p>Create a .env file with the following variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DSPACE_PYTHON_CLIENT_ENV</span><span class="o">=</span><span class="n">vcr_create_cassettes</span>
<span class="n">TEST_DSPACE_API_URL</span><span class="o">=&lt;</span><span class="n">your</span> <span class="n">test</span> <span class="n">DSpace</span> <span class="n">instance</span> <span class="n">API</span> <span class="n">url</span><span class="o">&gt;</span>
<span class="n">TEST_DSPACE_EMAIL</span><span class="o">=&lt;</span><span class="n">your</span> <span class="n">test</span> <span class="n">DSpace</span> <span class="n">instance</span> <span class="n">email</span><span class="o">&gt;</span>
<span class="n">TEST_DSPACE_PASSWORD</span><span class="o">=&lt;</span><span class="n">your</span> <span class="n">test</span> <span class="n">DSpace</span> <span class="n">instance</span> <span class="n">password</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>Delete any test cassettes you want to replace. VCR is set to run once, meaning it will not overwrite existing cassettes.</p></li>
<li><p>If the tests you want to create cassettes for use the <code class="docutils literal notranslate"><span class="pre">test_client</span></code> fixture, you will need to update it. In <code class="docutils literal notranslate"><span class="pre">tests/conftest.py</span></code>, comment out the <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">my_vcr.use_cassette(...</span></code> line of the <code class="docutils literal notranslate"><span class="pre">test_client</span></code> fixture and adjust the indenting so the whole fixture function looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">test_client</span><span class="p">(</span><span class="n">my_vcr</span><span class="p">,</span> <span class="n">vcr_env</span><span class="p">):</span>
    <span class="c1"># with my_vcr.use_cassette(&quot;tests/vcr_cassettes/client/login.yaml&quot;):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">DSpaceClient</span><span class="p">(</span><span class="n">vcr_env</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>
    <span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">vcr_env</span><span class="p">[</span><span class="s2">&quot;email&quot;</span><span class="p">],</span> <span class="n">vcr_env</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">client</span>
</pre></div>
</div>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> to run the tests. This will run all tests with API calls against <em>your real</em> DSpace test instance and record the requests/responses as cassettes.</p></li>
<li><p>Review new cassettes to make sure no sensitive data has been recorded. If it has, add to the vcr functions in <code class="docutils literal notranslate"><span class="pre">conftest.py</span></code> to scrub the sensitive data and rerun <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> to confirm.</p></li>
<li><p><em>VERY IMPORTANT</em>: comment out the <code class="docutils literal notranslate"><span class="pre">DSPACE_PYTHON_CLIENT_ENV</span></code> variable in your .env file. And reset the <cite>test_client</cite> fixture to its previous state. This ensures that future local test runs use the cassettes instead of making calls to the real DSpace API.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> again to confirm that your cassettes are working properly.</p></li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="source/modules.html" class="btn btn-neutral float-right" title="dspace" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="dspace-python-client Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MIT Libraries.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>